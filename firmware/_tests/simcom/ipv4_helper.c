/* 
 * File:   com_helper.c
 * Author: jtrodriguez
 *
 * Created on 24 de febrero de 2021, 8:07
 */

/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Included Files                                                    */
/* ************************************************************************** */
/* ************************************************************************** */
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include <stdio.h>

#include "ipv4_helper.h"

/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Constants                                                         */
/* ************************************************************************** */
/* ************************************************************************** */


/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Data types & Definitions                                          */
/* ************************************************************************** */
/* ************************************************************************** */


/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Global data & variables                                           */
/* ************************************************************************** */
/* ************************************************************************** */


/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Callback Functions                                                */
/* ************************************************************************** */
/* ************************************************************************** */


/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Local Functions                                                   */
/* ************************************************************************** */
/* ************************************************************************** */


/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Interface Functions                                               */
/* ************************************************************************** */

/* ************************************************************************** */
char* iph_ip2str (t_IPV4_ADDR ip)
{
  static char ipStr[IPV4_ADDR_STR_MAX_SIZE];
  snprintf (ipStr, IPV4_ADDR_STR_MAX_SIZE, "%d.%d.%d.%d", ip.o3, ip.o2, ip.o1, ip.o0);
  return ipStr;
}

uint32_t iph_ip2str_copy (t_IPV4_ADDR ip, char *s)
{
  return snprintf (s, IPV4_ADDR_STR_MAX_SIZE, "%d.%d.%d.%d", ip.o3, ip.o2, ip.o1, ip.o0);
}

t_IPV4_ADDR iph_str2ip (char *s)
{
  char* tok;
  t_IPV4_ADDR ip;
  uint8_t i = 0;

  tok = strtok (s, ".");
  while (tok)
    {
      ip.sv[i] = atoi (tok);
      i++;
      tok = strtok (NULL, ".");
    }
  if (i < IPV4_ADDR_OCTETOS) ip.v = IPV4_INVALID_ADDR;

  return ip;
}

/* ************************************************************** End of File */
